# Задание 1. Проектирование технологической архитектуры

1. **Ссылка на диаграмму:** [InureTech_технологическая_архитектура_to-be.drawio.xml](./InureTech_технологическая_архитектура_to-be.drawio.png)

---

## Стратегия масштабирования и отказоустойчивости

- Масштабирование: **горизонтальное** (HPA/VPA, Cluster Autoscaler) для stateless-сервисов и **вертикальное** для PostgreSQL и Managed Valkey.  
- Развёртывание: два региона (Primary, DR), каждый с несколькими AZ. Независимые кластеры Kubernetes снижают blast radius.  
- Геораспределение: **Global Load Balancer + Yandex CDN** для равномерного времени отклика по всей РФ.  

**Вывод:** Архитектура поддерживает рост нагрузки, устойчивость к сбоям и доступность 24/7.

---

## Балансировка нагрузки

- **Global LB** распределяет трафик между регионами, исключая недоступные.  
- **Application LB (L7)** балансирует трафик между подами, поддерживает `/healthz` и blue-green деплой.  
- **CDN** кэширует статику, снижая задержки.  
- **Безопасность:** rate-limiting для B2B, WAF и DDoS-защита.  

**Вывод:** Многоуровневая балансировка гарантирует стабильный отклик и защиту системы.

---

## Фейловер-стратегия

- **Active-Active** для приложений, **Active-Passive** для БД.  
- Асинхронная реплика PostgreSQL в регионе B (лаг ≤15 мин).  
- **Failover:** автоматическое переключение LB + ручное продвижение реплики.  
- **RTO ≤45 мин, RPO ≤15 мин.**  

**Вывод:** Архитектура удовлетворяет требованиям отказоустойчивости и быстрого восстановления.

---

## Конфигурация базы данных

- **Managed PostgreSQL:** primary + синхронная реплика в AZ, асинхронная — в DR-регион.  
- **PITR**, архив WAL в Object Storage, snapshots.  
- Подключение через **pgbouncer**, мониторинг replication lag.  
- **Шардирование** пока не требуется (объём 50 ГБ).  

**Вывод:** Конфигурация БД надёжна и соответствует требованиям RTO/RPO.

---

## SLA и наблюдаемость

- **Цель:** доступность 99.9% (≤43.8 мин простоя/мес).  
- **Мониторинг:** Prometheus, Grafana, Loki/ELK, OpenTelemetry.  
- **Метрики:** latency p95/p99, error rate, replication lag, время failover.  
- **Безопасность:** mTLS, rate-limit, контроль SLA партнёров.  

**Вывод:** Система наблюдаема, безопасна и управляемо поддерживает SLA 99.9%.
